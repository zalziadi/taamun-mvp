# قائمة مراجعة المطور

## معلومات المشروع
- اسم المشروع: `taamun-mvp`
- هدف هذه القائمة: تقييم جاهزية التسليم للمطورين بشكل سريع وواضح.

| القسم | الحالة | الملاحظة | الإجراء المقترح |
|---|---|---|---|
| 1. المقدمة والنطاق | ✓ | النطاق واضح: سلة + Checkout + Stripe بدون تغيير هوية الواجهة. | حدّث قسم النطاق كلما أضيفت ميزة جديدة. |
| 2. هيكل المشروع | ✓ | الإضافات الجديدة منظمة داخل بنية Next App Router الحالية. | أضف خريطة معمارية مختصرة في `README.md`. |
| 3. التكامل الخلفي | ✓ | تم ربط Supabase + Stripe (سلة، جلسة دفع، webhook، تأكيد الدفع). | أضف أمثلة طلب/استجابة للـ API في ملف توثيق. |
| 4. إدارة الحالة | ⚠️ | الاعتماد الحالي على state محلي مناسب للحجم الحالي. | إن زاد تعقيد السلة، أضف hook/store مشترك. |
| 5. توثيق بيئة التطوير | ⚠️ | متغيرات البيئة موثقة في ملفات التسليم. | أضف `.env.example` بقيم آمنة توضيحية. |
| 6. تغطية الاختبارات | ⚠️ | يوجد build/lint/smoke checks، لكن لا توجد اختبارات تكامل آلية بعد. | أضف اختبارات للـ checkout/webhook/confirm. |
| 7. الأداء | ⚠️ | لا يوجد تراجع ظاهر، لكن لا يوجد تقرير Web Vitals مرفق. | أضف لقطة أداء سريعة للصفحات الأساسية. |
| 8. الأمان | ✓ | المسارات المحمية تعيد 401 بدون تسجيل دخول، وWebhook Stripe يتحقق من التوقيع. | أضف rate-limit لمسارات الدفع/التوثيق عند الحاجة. |
| 9. إمكانية الوصول | ⚠️ | لا يوجد تقرير a11y مخصص للصفحات الجديدة. | نفّذ فحص axe سريع وعالج الملاحظات الحرجة. |
| 10. الاتساق البصري | ✓ | تم الحفاظ على الهوية الحالية، والتعديلات تكاملية فقط. | استمر باستخدام نفس مكونات ونمط المشروع. |
| 11. جودة التسليم للمطور | ✓ | توجد 3 نسخ تسليم (`md`, `txt`, نسخة طباعة). | أضف changelog مختصر مع كل نسخة نشر. |
| 12. الجاهزية للإطلاق | ⚠️ | التدفق جاهز تقنيًا، ويتبقى إعداد Stripe + env + migration على البيئة الفعلية. | نفّذ اختبار دفع كامل على Staging قبل الإنتاج. |

## دلائل الحالة الحالية
- البناء (`build`) ناجح.
- الفحص (`lint`) ناجح مع تحذيرات غير مانعة.
- تم تنفيذ اختبارات smoke للمسارات والـ API.
- تم إنشاء migration لجداول `cart_items` و`orders` و`order_items` مع RLS.

## متطلبات إلزامية قبل الإنتاج
1. تطبيق migration على Supabase.
2. ضبط متغيرات البيئة الإنتاجية (`STRIPE_SECRET_KEY`, `STRIPE_WEBHOOK_SECRET`, `NEXT_PUBLIC_APP_URL` وغيرها).
3. توجيه Stripe Webhook إلى: `/api/webhooks/stripe`.
4. تنفيذ اختبار E2E كامل ببطاقات Stripe التجريبية على Staging.
5. التحقق من تفعيل entitlement تلقائيًا بعد نجاح الدفع.

## تحسينات اختيارية لاحقة
- إضافة ملف `docs/api-checkout.md` مع أمثلة payload.
- إضافة خطة rollback واضحة لتدفق الدفع.
- إضافة حزمة اختبارات تكامل أساسية لمسارات الدفع.
